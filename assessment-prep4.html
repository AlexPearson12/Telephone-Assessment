<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prepare for Your Assessment</title>
    <style>
        /* GOV.UK Design System Styling */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "GDS Transport", Arial, sans-serif;
            font-size: 19px;
            line-height: 1.5;
            color: #0b0c0c;
            background: #f3f2f1;
            padding: 0;
            -webkit-font-smoothing: antialiased;
        }

        .govuk-width-container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 15px;
        }

        @media (min-width: 641px) {
            .govuk-width-container {
                padding: 0 30px;
            }
        }

        /* Improved Header with colored accent */
        .header {
            background: white;
            padding: 20px 0;
            border-bottom: 4px solid #00703c;
            margin-bottom: 30px;
        }

        .header-container {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        @media (min-width: 641px) {
            .header-container {
                padding: 0 30px;
            }
        }

        .logo {
            font-size: 30px;
            font-weight: bold;
            color: #003078;
        }

        @media (max-width: 400px) {
            .logo {
                font-size: 24px;
            }
        }

        /* Main Content */
        .govuk-main-wrapper {
            background: white;
            padding: 30px 15px 40px 15px;
            min-height: calc(100vh - 200px);
        }

        @media (min-width: 641px) {
            .govuk-main-wrapper {
                padding: 30px 30px 40px 30px;
            }
        }

        .hidden {
            display: none !important;
        }

        /* Overall Progress Indicator */
        .overall-progress-container {
            background: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .progress-wrapper {
            max-width: 960px;
            margin: 0 auto;
            padding: 0 15px;
        }

        @media (min-width: 641px) {
            .progress-wrapper {
                padding: 0 30px;
            }
        }

        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
            margin-bottom: 10px;
        }

        .progress-line {
            position: absolute;
            top: 20px;
            left: 0;
            right: 0;
            height: 4px;
            background: #b1b4b6;
            z-index: 0;
        }

        .progress-line-fill {
            height: 100%;
            background: #00703c;
            transition: width 0.5s ease;
            width: 0%;
        }

        .progress-step {
            position: relative;
            z-index: 1;
            flex: 1;
            text-align: center;
        }

        .progress-step:first-child {
            text-align: left;
        }

        .progress-step:last-child {
            text-align: right;
        }

        .progress-dot {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #b1b4b6;
            border: 4px solid white;
            margin: 0 auto 8px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
        }

        .progress-step:first-child .progress-dot {
            margin-left: 0;
        }

        .progress-step:last-child .progress-dot {
            margin-right: 0;
        }

        .progress-dot.active {
            background: #1d70b8;
            transform: scale(1.1);
        }

        .progress-dot.complete {
            background: #00703c;
        }

        .progress-dot.complete::after {
            content: "✓";
            color: white;
            font-size: 20px;
        }

        .progress-label {
            font-size: 14px;
            font-weight: 600;
            color: #505a5f;
        }

        .progress-step.active .progress-label {
            color: #1d70b8;
        }

        .progress-step.complete .progress-label {
            color: #00703c;
        }

        @media (max-width: 640px) {
            .progress-dot {
                width: 32px;
                height: 32px;
            }

            .progress-label {
                font-size: 12px;
            }
        }

        /* Typography */
        .govuk-heading-xl {
            font-size: 48px;
            line-height: 1.09375;
            font-weight: bold;
            margin-bottom: 30px;
            margin-top: 15px;
        }

        .govuk-heading-l {
            font-size: 36px;
            line-height: 1.11111;
            font-weight: bold;
            margin-bottom: 20px;
            margin-top: 15px;
        }

        .govuk-heading-m {
            font-size: 24px;
            line-height: 1.25;
            font-weight: bold;
            margin-bottom: 15px;
            margin-top: 15px;
        }

        .govuk-body {
            font-size: 19px;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .govuk-body-lead {
            font-size: 24px;
            line-height: 1.46;
            color: #0b0c0c;
            margin-bottom: 30px;
        }

        @media (max-width: 640px) {
            .govuk-heading-xl {
                font-size: 32px;
            }
            .govuk-heading-l {
                font-size: 24px;
            }
            .govuk-body-lead {
                font-size: 20px;
            }
        }

        /* Buttons with micro-interactions */
        .govuk-button {
            font-size: 19px;
            line-height: 1.1875;
            padding: 12px 30px;
            border: 2px solid #004620;
            box-shadow: 0 0 0 2px #ffffff inset;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 400;
            text-align: center;
            display: inline-block;
            margin-bottom: 15px;
            margin-right: 15px;
            background: #00703c;
            color: white;
            text-decoration: none;
            transition: all 0.2s ease;
        }

        .govuk-button:hover {
            background: #005a30;
            border-color: #002d14;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,112,60,0.2);
        }

        .govuk-button:active {
            transform: translateY(0);
        }

        .govuk-button:focus,
        .govuk-button:focus-visible {
            outline: 3px solid #ffdd00;
            outline-offset: 2px;
            box-shadow: 0 0 0 3px #ffdd00;
        }

        .govuk-button:disabled {
            background: #b1b4b6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .govuk-button--secondary {
            background: #f3f2f1;
            color: #0b0c0c;
            border: 2px solid #505a5f;
        }

        .govuk-button--secondary:hover {
            background: #dbdad9;
            border-color: #0b0c0c;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .govuk-button--secondary:focus,
        .govuk-button--secondary:focus-visible {
            outline: 3px solid #ffdd00;
            outline-offset: 2px;
            box-shadow: 0 0 0 3px #ffdd00;
        }

        @media (max-width: 640px) {
            .govuk-button {
                width: 100%;
                display: block;
                margin-right: 0;
            }
        }

        /* Back Link */
        .govuk-back-link {
            font-size: 16px;
            line-height: 1.25;
            display: inline-block;
            margin-bottom: 15px;
            margin-top: 15px;
            text-decoration: none;
            color: #0b0c0c;
            border-bottom: 1px solid #0b0c0c;
        }

        .govuk-back-link:hover {
            color: #0b0c0c;
            border-bottom-color: transparent;
        }

        .govuk-back-link::before {
            content: "";
            display: inline-block;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 5px 6px 5px 0;
            border-color: transparent #0b0c0c transparent transparent;
            margin-right: 5px;
        }

        /* Video Player */
        .video-container {
            position: relative;
            background: linear-gradient(135deg, #003078 0%, #1d70b8 100%);
            border-radius: 4px;
            overflow: hidden;
            margin: 30px 0;
            aspect-ratio: 16 / 9;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-player {
            width: 100%;
            height: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .video-visual {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        /* Scene Illustration */
        .scene-container {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 50px;
            padding: 40px;
            opacity: 0.15;
        }

        .character {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .character-head {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 50%;
            position: relative;
            animation: nod 4s ease-in-out infinite;
        }

        .character-face {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .character-eyes {
            display: flex;
            gap: 12px;
            margin-bottom: 8px;
        }

        .eye {
            width: 8px;
            height: 8px;
            background: #003078;
            border-radius: 50%;
            animation: blink 5s ease-in-out infinite;
        }

        .character-smile {
            width: 20px;
            height: 10px;
            border: 2px solid #003078;
            border-top: none;
            border-radius: 0 0 20px 20px;
        }

        @keyframes blink {
            0%, 48%, 52%, 100% { transform: scaleY(1); }
            50% { transform: scaleY(0.1); }
        }

        @keyframes nod {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-3px) rotate(-2deg); }
            75% { transform: translateY(-3px) rotate(2deg); }
        }

        .character-body {
            width: 80px;
            height: 100px;
            background: white;
            border-radius: 40px 40px 10px 10px;
            position: relative;
        }

        .character-arms {
            position: absolute;
            top: 20px;
            width: 100%;
        }

        .character-arm {
            width: 35px;
            height: 8px;
            background: white;
            border-radius: 10px;
            position: absolute;
        }

        .character-arm.left {
            left: -25px;
            transform: rotate(-45deg);
            transform-origin: right center;
            animation: wave-left 3s ease-in-out infinite;
        }

        .character-arm.right {
            right: -25px;
            transform: rotate(45deg);
            transform-origin: left center;
            animation: wave-right 3s ease-in-out infinite;
        }

        @keyframes wave-left {
            0%, 100% { transform: rotate(-45deg); }
            50% { transform: rotate(-30deg); }
        }

        @keyframes wave-right {
            0%, 100% { transform: rotate(45deg); }
            50% { transform: rotate(30deg); }
        }

        /* Scene Items */
        .scene-items {
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: flex-start;
        }

        .scene-item {
            display: flex;
            align-items: center;
            gap: 15px;
            animation: float 3s ease-in-out infinite;
        }

        .scene-item:nth-child(2) {
            animation-delay: 1s;
        }

        .scene-item:nth-child(3) {
            animation-delay: 2s;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); opacity: 0.15; }
            50% { transform: translateY(-10px); opacity: 0.25; }
        }

        .item-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .document-icon {
            width: 40px;
            height: 50px;
            background: white;
            border-radius: 4px;
            position: relative;
        }

        .document-icon::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            height: 2px;
            background: rgba(0, 48, 120, 0.3);
            box-shadow: 0 6px 0 rgba(0, 48, 120, 0.3), 0 12px 0 rgba(0, 48, 120, 0.3);
        }

        .phone-icon {
            width: 35px;
            height: 55px;
            background: white;
            border-radius: 8px;
            border: 3px solid white;
            position: relative;
        }

        .phone-icon::before {
            content: '';
            position: absolute;
            bottom: 5px;
            left: 50%;
            transform: translateX(-50%);
            width: 15px;
            height: 3px;
            background: rgba(0, 48, 120, 0.3);
            border-radius: 2px;
        }

        .checkmark-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .checkmark-icon::after {
            content: '✓';
            color: #00703c;
            font-size: 28px;
            font-weight: bold;
        }

        .item-label {
            color: white;
            font-size: 14px;
            font-weight: 600;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .audio-wave {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            height: 100px;
            position: relative;
            z-index: 5;
        }

        .wave-bar {
            width: 6px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 3px;
            animation: wave 1.2s ease-in-out infinite;
        }

        .wave-bar:nth-child(1) { height: 20px; animation-delay: 0s; }
        .wave-bar:nth-child(2) { height: 40px; animation-delay: 0.1s; }
        .wave-bar:nth-child(3) { height: 60px; animation-delay: 0.2s; }
        .wave-bar:nth-child(4) { height: 80px; animation-delay: 0.3s; }
        .wave-bar:nth-child(5) { height: 60px; animation-delay: 0.4s; }
        .wave-bar:nth-child(6) { height: 40px; animation-delay: 0.5s; }
        .wave-bar:nth-child(7) { height: 20px; animation-delay: 0.6s; }

        @keyframes wave {
            0%, 100% { transform: scaleY(1); opacity: 0.8; }
            50% { transform: scaleY(1.5); opacity: 1; }
        }

        .wave-bar.paused {
            animation: none;
            height: 20px !important;
            opacity: 0.5;
        }

        /* Bottom control bar with play/pause and skip buttons */
        .video-progress-section {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            z-index: 10;
        }

        .control-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: all 0.2s ease;
            color: #0b0c0c;
        }

        .control-btn:hover {
            background: white;
            transform: scale(1.05);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        .control-btn.play-pause-control {
            width: 52px;
            height: 52px;
            font-size: 22px;
            background: white;
        }

        .skip-text {
            font-size: 10px;
            font-weight: bold;
            margin-top: -2px;
        }

        .video-progress-container {
            width: 100%;
            background: rgba(255, 255, 255, 0.3);
            height: 16px;
            border-radius: 8px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .video-progress-bar {
            height: 100%;
            background: white;
            border-radius: 8px;
            width: 0%;
            transition: width 0.1s linear;
        }

        .video-time {
            font-size: 14px;
            color: white;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            text-align: center;
        }

        @media (max-width: 640px) {
            .control-btn {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .control-btn.play-pause-control {
                width: 48px;
                height: 48px;
                font-size: 20px;
            }

            .video-progress-container {
                height: 14px;
            }
        }

        .video-placeholder {
            color: white;
            text-align: center;
            padding: 40px;
        }

        .video-placeholder-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .play-button {
            background: #00703c;
            border: none;
            color: white;
            font-size: 18px;
            padding: 15px 40px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .play-button:hover {
            background: #005a30;
            transform: translateY(-2px);
        }

        /* Improved Inset Text with color hierarchy */
        .govuk-inset-text {
            padding: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #b1b4b6;
            background: #f3f2f1;
        }

        .govuk-inset-text--blue {
            border-left-color: #1d70b8;
            background: #f0f4f7;
        }

        .govuk-inset-text p:last-child {
            margin-bottom: 0;
        }

        /* Improved Progress indicator - Slim bar design */
        .progress-indicator {
            margin-bottom: 30px;
        }

        .progress-bar-container {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 5px;
            border: none;
            position: relative;
        }

        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #00703c 0%, #00a650 100%);
            border-radius: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .progress-bar-text {
            font-size: 14px;
            color: #505a5f;
            text-align: right;
            margin-top: 5px;
            display: block;
        }

        /* Checklist */
        .checklist {
            margin: 30px 0;
        }

        .checklist-section {
            margin-bottom: 40px;
        }

        .checklist-item {
            background: white;
            border: 2px solid #e8e8e8;
            border-radius: 4px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.2s ease;
            position: relative;
        }

        .checklist-item:hover {
            border-color: #b1b4b6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .checklist-item.completed {
            background: #f0f8f5;
            border-color: #00703c;
        }

        .checklist-checkbox {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .checklist-checkbox input[type="checkbox"] {
            width: 40px;
            height: 40px;
            min-width: 40px;
            margin-right: 15px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .checklist-label {
            font-size: 19px;
            font-weight: 600;
            cursor: pointer;
            flex: 1;
        }

        .checklist-description {
            margin-left: 55px;
            margin-top: 10px;
            color: #505a5f;
            font-size: 17px;
        }

        /* Improved Image Placeholder */
        .image-placeholder {
            background: 
                linear-gradient(135deg, #f3f2f1 25%, transparent 25%),
                linear-gradient(225deg, #f3f2f1 25%, transparent 25%),
                linear-gradient(45deg, #f3f2f1 25%, transparent 25%),
                linear-gradient(315deg, #f3f2f1 25%, #e8e8e8 25%);
            background-size: 20px 20px;
            border: 2px dashed #b1b4b6;
            padding: 40px;
            text-align: center;
            color: #505a5f;
            font-style: italic;
            margin: 15px 0 15px 55px;
            border-radius: 4px;
        }

        .image-placeholder::before {
            content: "📄";
            display: block;
            font-size: 48px;
            margin-bottom: 10px;
        }

        /* Visual Examples */
        .visual-example {
            margin: 20px 0 20px 55px;
            padding: 30px;
            background: #f8f8f8;
            border: 2px solid #b1b4b6;
            border-radius: 4px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 180px;
        }

        /* NI Number Document */
        .ni-document {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .document-card {
            width: 140px;
            height: 180px;
            background: white;
            border: 2px solid #0b0c0c;
            border-radius: 4px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
            display: flex;
            flex-direction: column;
        }

        .document-lines {
            width: 100%;
            height: 4px;
            background: #e8e8e8;
            margin-bottom: 8px;
            border-radius: 2px;
        }

        .ni-highlight {
            background: #ffeb3b;
            padding: 5px;
            font-weight: bold;
            font-size: 11px;
            text-align: center;
            border-radius: 2px;
            margin-top: auto;
            font-family: monospace;
        }

        .document-label {
            font-size: 10px;
            text-align: center;
            margin-top: 8px;
            color: #505a5f;
            font-weight: 600;
        }

        /* Medication Boxes */
        .medication-boxes {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .med-box {
            width: 100px;
            height: 120px;
            background: linear-gradient(180deg, #ffffff 0%, #f0f0f0 100%);
            border: 2px solid #1d70b8;
            border-radius: 4px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
        }

        .med-label {
            font-size: 11px;
            font-weight: bold;
            text-align: center;
            color: #0b0c0c;
            line-height: 1.2;
        }

        .pill-icon {
            font-size: 32px;
        }

        .dosage {
            font-size: 9px;
            color: #505a5f;
            text-align: center;
        }

        /* GP Letters */
        .letter-stack {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .letter {
            width: 120px;
            height: 160px;
            background: white;
            border: 2px solid #0b0c0c;
            border-radius: 4px;
            padding: 12px;
            box-shadow: 0 3px 6px rgba(0,0,0,0.12);
            position: relative;
        }

        .letter-header {
            height: 30px;
            background: #003078;
            margin: -12px -12px 10px -12px;
            border-radius: 2px 2px 0 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 10px;
            font-weight: bold;
        }

        .letter-content {
            width: 100%;
            height: 3px;
            background: #e8e8e8;
            margin-bottom: 6px;
            border-radius: 2px;
        }

        /* Comfort Items */
        .comfort-items {
            display: flex;
            gap: 30px;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }

        .water-glass {
            width: 50px;
            height: 70px;
            background: linear-gradient(180deg, rgba(29,112,184,0.3) 0%, rgba(29,112,184,0.5) 100%);
            border: 3px solid #1d70b8;
            border-radius: 0 0 8px 8px;
            position: relative;
            box-shadow: inset 0 -20px 20px rgba(255,255,255,0.3);
        }

        .water-glass::after {
            content: '';
            position: absolute;
            top: 10px;
            right: 5px;
            width: 8px;
            height: 8px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
        }

        .cushion {
            width: 80px;
            height: 60px;
            background: linear-gradient(135deg, #00703c 0%, #005a30 100%);
            border-radius: 40px 40px 20px 20px;
            position: relative;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .cushion::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
        }

        .headphones {
            width: 70px;
            height: 70px;
            position: relative;
        }

        .headphones::before {
            content: '';
            position: absolute;
            top: 0;
            left: 15px;
            width: 40px;
            height: 30px;
            border: 4px solid #0b0c0c;
            border-bottom: none;
            border-radius: 40px 40px 0 0;
        }

        .headphones::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 5px;
            width: 60px;
            height: 40px;
            background: 
                radial-gradient(circle at 15px 20px, #0b0c0c 12px, transparent 13px),
                radial-gradient(circle at 45px 20px, #0b0c0c 12px, transparent 13px);
        }

        /* Charging Phone */
        .phone-charging {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .phone {
            width: 80px;
            height: 140px;
            background: #0b0c0c;
            border-radius: 12px;
            padding: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            position: relative;
        }

        .phone-screen {
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg, #1d70b8 0%, #003078 100%);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
        }

        .charging-icon {
            position: absolute;
            top: 12px;
            right: 12px;
            color: #00ff00;
            font-size: 16px;
        }

        .cable {
            width: 4px;
            height: 30px;
            background: #505a5f;
            border-radius: 2px;
        }

        .plug {
            width: 30px;
            height: 20px;
            background: white;
            border: 2px solid #505a5f;
            border-radius: 4px;
        }

        .item-label {
            margin-top: 10px;
            font-size: 12px;
            color: #505a5f;
            text-align: center;
            font-weight: 600;
        }

        /* Ready Screen */
        .ready-screen {
            text-align: center;
            padding: 60px 40px;
        }

        .ready-icon {
            font-size: 80px;
            margin-bottom: 30px;
        }

        .ready-screen .govuk-heading-xl {
            color: #00703c;
        }

        /* Fade in animation */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        @media (max-width: 640px) {
            .govuk-main-wrapper {
                padding: 20px 15px 30px 15px;
            }

            .checklist-description,
            .visual-example {
                margin-left: 0;
                margin-top: 15px;
            }

            .ready-screen {
                padding: 40px 20px;
            }

            .document-card {
                width: 110px;
                height: 150px;
                padding: 10px;
            }

            .ni-highlight {
                font-size: 10px;
                padding: 4px;
            }

            .med-box {
                width: 85px;
                height: 110px;
                padding: 8px;
            }

            .letter {
                width: 100px;
                height: 140px;
                padding: 10px;
            }

            .visual-example {
                padding: 20px;
                min-height: 150px;
            }

            .video-progress-section {
                padding: 10px 15px;
            }

            .video-progress-container {
                height: 6px;
            }

            .video-time {
                font-size: 12px;
            }

            .audio-wave {
                gap: 6px;
                height: 80px;
            }

            .wave-bar {
                width: 4px;
            }

            .scene-container {
                gap: 30px;
                padding: 20px;
                flex-direction: column;
            }

            .character-head {
                width: 45px;
                height: 45px;
            }

            .character-body {
                width: 60px;
                height: 75px;
            }

            .character-arm {
                width: 25px;
                height: 6px;
            }

            .character-arm.left {
                left: -18px;
            }

            .character-arm.right {
                right: -18px;
            }

            .scene-items {
                gap: 20px;
                align-items: center;
            }

            .scene-item {
                gap: 10px;
            }

            .document-icon {
                width: 30px;
                height: 40px;
            }

            .phone-icon {
                width: 28px;
                height: 45px;
            }

            .checkmark-icon {
                width: 40px;
                height: 40px;
            }

            .checkmark-icon::after {
                font-size: 22px;
            }

            .item-label {
                font-size: 12px;
            }
        }

        /* Assessment Segments Stage */
        .segment-selection {
            margin: 40px 0;
        }

        .segment-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .segment-card {
            background: white;
            border: 2px solid #b1b4b6;
            border-radius: 4px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .segment-card:hover {
            border-color: #1d70b8;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .segment-card:active {
            transform: translateY(0);
        }

        .segment-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .segment-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #0b0c0c;
        }

        .segment-description {
            font-size: 16px;
            color: #505a5f;
            line-height: 1.4;
        }

        .segment-player-container {
            margin: 40px 0;
        }

        .version-toggle-section {
            background: #f0f4f7;
            border-left: 5px solid #1d70b8;
            padding: 20px;
            margin-bottom: 30px;
        }

        .version-toggle-section h3 {
            font-size: 19px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #0b0c0c;
        }

        .version-toggle-section p {
            font-size: 17px;
            margin-bottom: 20px;
            color: #0b0c0c;
        }

        .radio-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .radio-option {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .radio-option:hover {
            background: rgba(29, 112, 184, 0.05);
        }

        .radio-option input[type="radio"] {
            margin-top: 3px;
            width: 44px;
            height: 44px;
            cursor: pointer;
            flex-shrink: 0;
            accent-color: #1d70b8;
        }

        .radio-option-content {
            flex: 1;
        }

        .radio-option-title {
            font-size: 17px;
            font-weight: bold;
            color: #0b0c0c;
            margin-bottom: 4px;
        }

        .radio-option-description {
            font-size: 16px;
            color: #505a5f;
            line-height: 1.4;
        }

        @media (max-width: 640px) {
            .segment-cards {
                grid-template-columns: 1fr;
            }

            .segment-card {
                padding: 20px;
            }

            .segment-icon {
                font-size: 36px;
            }

            .segment-title {
                font-size: 20px;
            }

            .toggle-container {
                flex-direction: column;
                gap: 10px;
            }

            .radio-options {
                gap: 12px;
            }

            .radio-option {
                gap: 10px;
            }

            .radio-option-title {
                font-size: 16px;
            }

            .radio-option-description {
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-container">
            <div class="logo">Prepare for Your Assessment</div>
        </div>
    </div>

    <!-- Overall Progress Indicator -->
    <div class="overall-progress-container">
        <div class="progress-wrapper">
            <div class="progress-steps">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressFill"></div>
                </div>
                <div class="progress-step" id="step1">
                    <div class="progress-dot">1</div>
                    <div class="progress-label">Watch Video</div>
                </div>
                <div class="progress-step" id="step2">
                    <div class="progress-dot">2</div>
                    <div class="progress-label">Prepare</div>
                </div>
                <div class="progress-step" id="step3">
                    <div class="progress-dot">3</div>
                    <div class="progress-label">Ready</div>
                </div>
                <div class="progress-step" id="step4">
                    <div class="progress-dot">4</div>
                    <div class="progress-label">Examples</div>
                </div>
            </div>
        </div>
    </div>

    <div class="govuk-width-container">
        <main class="govuk-main-wrapper" id="main-content" role="main">
            <!-- Stage 1: Video Introduction -->
            <div id="stage1" class="fade-in">
                <h1 class="govuk-heading-xl">Before we begin</h1>
                <p class="govuk-body-lead">Watch this short video first. It's important.</p>

            <div class="video-container">
                <div class="video-player">
                    <audio id="videoAudio" preload="auto">
                        <source src="intro-video-audio.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                    
                    <div class="video-visual">
                        <!-- Background Scene Illustration -->
                        <div class="scene-container">
                            <!-- Character -->
                            <div class="character">
                                <div class="character-head">
                                    <div class="character-face">
                                        <div class="character-eyes">
                                            <div class="eye"></div>
                                            <div class="eye"></div>
                                        </div>
                                        <div class="character-smile"></div>
                                    </div>
                                </div>
                                <div class="character-body">
                                    <div class="character-arms">
                                        <div class="character-arm left"></div>
                                        <div class="character-arm right"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Scene Items -->
                            <div class="scene-items">
                                <div class="scene-item">
                                    <div class="document-icon"></div>
                                    <div class="item-label">Documents</div>
                                </div>
                                <div class="scene-item">
                                    <div class="phone-icon"></div>
                                    <div class="item-label">Ready</div>
                                </div>
                                <div class="scene-item">
                                    <div class="checkmark-icon"></div>
                                    <div class="item-label">Prepared</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Audio Wave Visualization -->
                        <div class="audio-wave">
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                        </div>
                    </div>

                    <div class="video-progress-section">
                        <div class="control-row">
                            <button class="control-btn" onclick="skipBackward('videoAudio')" aria-label="Skip back 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏪</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                            <button class="control-btn play-pause-control" id="mainPlayButton" onclick="toggleVideo()" aria-label="Play/Pause">
                                <span id="mainPlayIcon">▶</span>
                            </button>
                            <button class="control-btn" onclick="skipForward('videoAudio')" aria-label="Skip forward 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏩</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                        </div>
                        <div class="video-progress-container" onclick="seekVideo(event)" role="progressbar" aria-label="Video progress">
                            <div class="video-progress-bar" id="progressBar"></div>
                        </div>
                        <div class="video-time" aria-live="polite">
                            <span id="currentTime">0:00</span> / <span id="duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="text-align: center; margin: 20px 0;">
                <button class="govuk-button govuk-button--secondary" id="transcriptButton" onclick="toggleTranscript()">Transcript</button>
            </div>

            <div class="govuk-inset-text govuk-inset-text--blue" id="transcriptContent" style="display: none;">
                <p style="margin-bottom: 15px;">
                    You're getting ready for your health assessment. It's completely normal to feel anxious; this assessment is important to you. This video will help you understand what happens in a phone assessment so you can feel more at ease.
                </p>
                <p style="margin-bottom: 0;">
                    The healthcare professional you'll speak with hasn't met you before. They can only understand your situation through what you tell them. Their job is to listen to your experience and write it down accurately. They are not here to trick you. This isn't a test. You don't need to prove anything. Just describe your normal day. Let's walk through what to expect.
                </p>
            </div>

            <div style="margin-top: 30px; text-align: center;">
                <button class="govuk-button" onclick="moveToStage2()">Continue to Preparation</button>
            </div>
        </div>

        <!-- Stage 2: Interactive Preparation -->
        <div id="stage2" class="hidden">
            <h1 class="govuk-heading-xl">Let's walk through and practice getting everything ready for your assessment</h1>
            <p class="govuk-body-lead">This will work best if you're currently at home and have 5 minutes alone. If not, bookmark this page and come back when you can actually do this.</p>
            
            <p class="govuk-body"><strong>We are going to work through some steps. Tick them off as you go!</strong></p>

            <div class="progress-indicator">
                <div class="progress-bar-container">
                    <div class="progress-bar-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <span class="progress-bar-text" id="progressText">0 of 6 completed</span>
            </div>

            <div class="checklist">
                <!-- Step 1: Gather what you need -->
                <div class="checklist-section">
                    <h2 class="govuk-heading-m">Step 1: Gather what you need</h2>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check1" onchange="updateProgress()">
                            <span class="checklist-label">I have my National Insurance number ready</span>
                        </label>
                        <div class="checklist-description">
                            Find your National Insurance number. Write it down or take a photo.
                        </div>
                        <div class="visual-example">
                            <div class="ni-document">
                                <div class="document-card">
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="ni-highlight">QQ 12 34 56 C</div>
                                    <div class="document-label">Payslip</div>
                                </div>
                                <div class="document-card">
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="ni-highlight">QQ 12 34 56 C</div>
                                    <div class="document-label">Tax Letter</div>
                                </div>
                                <div class="document-card">
                                    <div class="document-lines"></div>
                                    <div class="document-lines"></div>
                                    <div class="ni-highlight">QQ 12 34 56 C</div>
                                    <div class="document-label">Benefits Letter</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check2" onchange="updateProgress()">
                            <span class="checklist-label">Medications ready</span>
                        </label>
                        <div class="checklist-description">
                            Have your medications nearby—the packets or boxes are fine.
                        </div>
                        <div class="visual-example">
                            <div class="medication-boxes">
                                <div class="med-box">
                                    <div class="med-label">Paracetamol</div>
                                    <div class="pill-icon">💊</div>
                                    <div class="dosage">500mg tablets</div>
                                </div>
                                <div class="med-box">
                                    <div class="med-label">Ibuprofen</div>
                                    <div class="pill-icon">💊</div>
                                    <div class="dosage">200mg tablets</div>
                                </div>
                                <div class="med-box">
                                    <div class="med-label">Prescription</div>
                                    <div class="pill-icon">💊</div>
                                    <div class="dosage">Various</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check3" onchange="updateProgress()">
                            <span class="checklist-label">Done (or I don't have any)</span>
                        </label>
                        <div class="checklist-description">
                            If you have recent letters from your GP or hospital, have those nearby.
                        </div>
                        <div class="visual-example">
                            <div class="letter-stack">
                                <div class="letter">
                                    <div class="letter-header">NHS</div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="document-label">GP Letter</div>
                                </div>
                                <div class="letter">
                                    <div class="letter-header">HOSPITAL</div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="document-label">Appointment</div>
                                </div>
                                <div class="letter">
                                    <div class="letter-header">NHS</div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="letter-content"></div>
                                    <div class="document-label">Diagnosis</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Set up your space -->
                <div class="checklist-section">
                    <h2 class="govuk-heading-m">Step 2: Set up your space</h2>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check4" onchange="updateProgress()">
                            <span class="checklist-label">Found my spot and checked the signal</span>
                        </label>
                        <div class="checklist-description">
                            Find the quietest spot in your home. Check your phone signal there.
                        </div>
                    </div>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check5" onchange="updateProgress()">
                            <span class="checklist-label">Water and anything else I need to be comfortable</span>
                        </label>
                        <div class="checklist-description">
                            Get comfortable. Have a glass of water within reach. If you use headphones, have those ready too.
                        </div>
                        <div class="visual-example">
                            <div class="comfort-items">
                                <div>
                                    <div class="water-glass"></div>
                                    <div class="item-label">Water</div>
                                </div>
                                <div>
                                    <div class="cushion"></div>
                                    <div class="item-label">Cushion</div>
                                </div>
                                <div>
                                    <div class="headphones"></div>
                                    <div class="item-label">Headphones</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="checklist-item">
                        <label class="checklist-checkbox">
                            <input type="checkbox" id="check6" onchange="updateProgress()">
                            <span class="checklist-label">Phone charging or charger ready</span>
                        </label>
                        <div class="checklist-description">
                            Plug your phone in or have the charger nearby.
                        </div>
                        <div class="visual-example">
                            <div class="phone-charging">
                                <div class="phone">
                                    <div class="phone-screen">
                                        📱
                                    </div>
                                    <div class="charging-icon">⚡</div>
                                </div>
                                <div class="cable"></div>
                                <div class="plug"></div>
                                <div class="item-label">Phone Charging</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="govuk-inset-text govuk-inset-text--blue">
                <p class="govuk-body" style="margin-bottom: 0;"><strong>You're ready. Now let's show you what the call sounds like.</strong></p>
            </div>

            <div style="text-align: center; margin-top: 40px;">
                <button class="govuk-button" id="finalButton" onclick="moveToFinal()" disabled>Continue</button>
                <p style="margin-top: 15px; color: #505a5f;">Complete all checklist items to continue</p>
            </div>
        </div>

        <!-- Stage 3: Ready Screen -->
        <div id="stage3" class="hidden">
            <div class="ready-screen">
                <div class="ready-icon">✓</div>
                <h1 class="govuk-heading-xl">Now you're prepared</h1>
                <p class="govuk-body-lead">Want to see what an assessment is really like?</p>
                
                <div style="margin-top: 40px;">
                    <button class="govuk-button" onclick="moveToStage4()">Listen to Assessment Examples</button>
                </div>

                <div style="margin-top: 40px;">
                    <button class="govuk-button govuk-button--secondary" onclick="window.print()">📄 Print this checklist</button>
                </div>
            </div>
        </div>

        <!-- Stage 4: Assessment Examples -->
        <div id="stage4" class="hidden">
            <h1 class="govuk-heading-xl">Listen to example assessments</h1>
            <p class="govuk-body-lead">Choose a section to hear what it sounds like during a real assessment.</p>

            <div class="govuk-inset-text govuk-inset-text--blue">
                <p class="govuk-body" style="margin-bottom: 0;">These examples use actors. Your actual assessment will be specific to you and your conditions.</p>
            </div>

            <div class="segment-selection">
                <div class="segment-cards">
                    <div class="segment-card" onclick="showSegment(1)">
                        <div class="segment-icon">👋</div>
                        <div class="segment-title">How it starts</div>
                        <div class="segment-description">The introduction and ID checks</div>
                    </div>

                    <div class="segment-card" onclick="showSegment(2)">
                        <div class="segment-icon">💬</div>
                        <div class="segment-title">Questions about your condition</div>
                        <div class="segment-description">Talking about your diagnosis and symptoms</div>
                    </div>

                    <div class="segment-card" onclick="showSegment(3)">
                        <div class="segment-icon">🏠</div>
                        <div class="segment-title">Daily activities</div>
                        <div class="segment-description">Questions about your typical day</div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 40px; text-align: center;">
                <button class="govuk-button govuk-button--secondary" onclick="backToReady()">Back to preparation summary</button>
            </div>
        </div>

        <!-- Stage 4 Segment Players -->
        <div id="segment1Player" class="hidden">
            <h1 class="govuk-heading-xl">How it starts</h1>
            <p class="govuk-body-lead">Listen to how the assessment begins with ID verification.</p>

            <div class="version-toggle-section">
                <h3>Worried you won't know what to say?</h3>
                <p>Listen to:</p>
                <div class="radio-options">
                    <label class="radio-option">
                        <input type="radio" name="segment1Version" value="clear" checked onchange="changeSegment1Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Rob's assessment</div>
                            <div class="radio-option-description">Rob answers confidently</div>
                        </div>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="segment1Version" value="unclear" onchange="changeSegment1Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Michael's assessment</div>
                            <div class="radio-option-description">Michael gets support when he's unsure</div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="video-container">
                <div class="video-player">
                    <audio id="segment1Audio" preload="auto">
                        <source id="segment1Source" src="ElevenLabs_Seg_1_Clear.mp3" type="audio/mpeg">
                    </audio>
                    
                    <div class="video-visual">
                        <div class="audio-wave">
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                        </div>
                    </div>

                    <div class="video-progress-section">
                        <div class="control-row">
                            <button class="control-btn" onclick="skipBackward('segment1Audio')" aria-label="Skip back 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏪</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                            <button class="control-btn play-pause-control" id="segment1PlayButton" onclick="toggleSegment1()" aria-label="Play/Pause">
                                <span id="segment1PlayIcon">▶</span>
                            </button>
                            <button class="control-btn" onclick="skipForward('segment1Audio')" aria-label="Skip forward 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏩</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                        </div>
                        <div class="video-progress-container" onclick="seekSegment1(event)" role="progressbar" aria-label="Audio progress">
                            <div class="video-progress-bar" id="segment1ProgressBar"></div>
                        </div>
                        <div class="video-time" aria-live="polite">
                            <span id="segment1CurrentTime">0:00</span> / <span id="segment1Duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center;">
                <button class="govuk-button govuk-button--secondary" id="segment1TranscriptButton" onclick="toggleSegmentTranscript(1)">Transcript</button>
            </div>

            <div class="govuk-inset-text govuk-inset-text--blue" id="segment1TranscriptContent" style="display: none; margin-top: 20px;">
                <p><strong>Transcript - How it starts (Rob's version)</strong></p>
                <p style="margin-top: 10px;">This segment shows the beginning of an assessment, including identity verification and introductions. The transcript would include the full conversation between the healthcare professional and claimant.</p>
            </div>

            <div style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <button class="govuk-button govuk-button--secondary" onclick="backToSegmentSelection()">← Back to examples</button>
                <button class="govuk-button" onclick="showSegment(2)">Next: Questions about your condition →</button>
            </div>
        </div>

        <div id="segment2Player" class="hidden">
            <h1 class="govuk-heading-xl">Questions about your condition</h1>
            <p class="govuk-body-lead">Listen to how they ask about your diagnosis and symptoms.</p>

            <div class="version-toggle-section">
                <h3>Worried you won't know what to say?</h3>
                <p>Listen to:</p>
                <div class="radio-options">
                    <label class="radio-option">
                        <input type="radio" name="segment2Version" value="clear" checked onchange="changeSegment2Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Rob's assessment</div>
                            <div class="radio-option-description">Rob answers confidently</div>
                        </div>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="segment2Version" value="unclear" onchange="changeSegment2Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Michael's assessment</div>
                            <div class="radio-option-description">Michael gets support when he's unsure</div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="video-container">
                <div class="video-player">
                    <audio id="segment2Audio" preload="auto">
                        <source id="segment2Source" src="ElevenLabs_Seg_2_Clear.mp3" type="audio/mpeg">
                    </audio>
                    
                    <div class="video-visual">
                        <div class="audio-wave">
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                        </div>
                    </div>

                    <div class="video-progress-section">
                        <div class="control-row">
                            <button class="control-btn" onclick="skipBackward('segment2Audio')" aria-label="Skip back 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏪</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                            <button class="control-btn play-pause-control" id="segment2PlayButton" onclick="toggleSegment2()" aria-label="Play/Pause">
                                <span id="segment2PlayIcon">▶</span>
                            </button>
                            <button class="control-btn" onclick="skipForward('segment2Audio')" aria-label="Skip forward 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏩</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                        </div>
                        <div class="video-progress-container" onclick="seekSegment2(event)" role="progressbar" aria-label="Audio progress">
                            <div class="video-progress-bar" id="segment2ProgressBar"></div>
                        </div>
                        <div class="video-time" aria-live="polite">
                            <span id="segment2CurrentTime">0:00</span> / <span id="segment2Duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center;">
                <button class="govuk-button govuk-button--secondary" id="segment2TranscriptButton" onclick="toggleSegmentTranscript(2)">Transcript</button>
            </div>

            <div class="govuk-inset-text govuk-inset-text--blue" id="segment2TranscriptContent" style="display: none; margin-top: 20px;">
                <p><strong>Transcript - Questions about your condition (Rob's version)</strong></p>
                <p style="margin-top: 10px;">This segment covers questions about diagnosis, symptoms, and medical history. The transcript would include the full conversation between the healthcare professional and claimant.</p>
            </div>

            <div style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <button class="govuk-button govuk-button--secondary" onclick="showSegment(1)">← Previous: How it starts</button>
                <button class="govuk-button" onclick="showSegment(3)">Next: Daily activities →</button>
            </div>
        </div>

        <div id="segment3Player" class="hidden">
            <h1 class="govuk-heading-xl">Daily activities</h1>
            <p class="govuk-body-lead">Listen to questions about your typical day and personal care.</p>

            <div class="version-toggle-section">
                <h3>Worried you won't know what to say?</h3>
                <p>Listen to:</p>
                <div class="radio-options">
                    <label class="radio-option">
                        <input type="radio" name="segment3Version" value="clear" checked onchange="changeSegment3Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Rob's assessment</div>
                            <div class="radio-option-description">Rob answers confidently</div>
                        </div>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="segment3Version" value="unclear" onchange="changeSegment3Version()">
                        <div class="radio-option-content">
                            <div class="radio-option-title">Michael's assessment</div>
                            <div class="radio-option-description">Michael gets support when he's unsure</div>
                        </div>
                    </label>
                </div>
            </div>

            <div class="video-container">
                <div class="video-player">
                    <audio id="segment3Audio" preload="auto">
                        <source id="segment3Source" src="ElevenLabs_Seg_3_-_Clear.mp3" type="audio/mpeg">
                    </audio>
                    
                    <div class="video-visual">
                        <div class="audio-wave">
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                            <div class="wave-bar paused"></div>
                        </div>
                    </div>

                    <div class="video-progress-section">
                        <div class="control-row">
                            <button class="control-btn" onclick="skipBackward('segment3Audio')" aria-label="Skip back 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏪</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                            <button class="control-btn play-pause-control" id="segment3PlayButton" onclick="toggleSegment3()" aria-label="Play/Pause">
                                <span id="segment3PlayIcon">▶</span>
                            </button>
                            <button class="control-btn" onclick="skipForward('segment3Audio')" aria-label="Skip forward 15 seconds">
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <span>⏩</span>
                                    <span class="skip-text">15s</span>
                                </div>
                            </button>
                        </div>
                        <div class="video-progress-container" onclick="seekSegment3(event)" role="progressbar" aria-label="Audio progress">
                            <div class="video-progress-bar" id="segment3ProgressBar"></div>
                        </div>
                        <div class="video-time" aria-live="polite">
                            <span id="segment3CurrentTime">0:00</span> / <span id="segment3Duration">0:00</span>
                        </div>
                    </div>
                </div>
            </div>

            <div style="margin-top: 20px; text-align: center;">
                <button class="govuk-button govuk-button--secondary" id="segment3TranscriptButton" onclick="toggleSegmentTranscript(3)">Transcript</button>
            </div>

            <div class="govuk-inset-text govuk-inset-text--blue" id="segment3TranscriptContent" style="display: none; margin-top: 20px;">
                <p><strong>Transcript - Daily activities (Rob's version)</strong></p>
                <p style="margin-top: 10px;">This segment explores typical daily activities and personal care routines. The transcript would include the full conversation between the healthcare professional and claimant.</p>
            </div>

            <div style="margin-top: 30px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                <button class="govuk-button govuk-button--secondary" onclick="showSegment(2)">← Previous: Questions about your condition</button>
                <button class="govuk-button govuk-button--secondary" onclick="backToSegmentSelection()">Back to examples</button>
            </div>
        </div>
    </main>
</div>

    <script>
        let totalItems = 6;
        let videoWatched = false;

        function toggleTranscript() {
            const transcript = document.getElementById('transcriptContent');
            const button = document.getElementById('transcriptButton');
            
            if (transcript.style.display === 'none') {
                transcript.style.display = 'block';
                button.textContent = 'Hide Transcript';
            } else {
                transcript.style.display = 'none';
                button.textContent = 'Transcript';
            }
        }

        function toggleSegmentTranscript(segmentNum) {
            const transcript = document.getElementById('segment' + segmentNum + 'TranscriptContent');
            const button = document.getElementById('segment' + segmentNum + 'TranscriptButton');
            
            if (transcript.style.display === 'none') {
                transcript.style.display = 'block';
                button.textContent = 'Hide Transcript';
            } else {
                transcript.style.display = 'none';
                button.textContent = 'Transcript';
            }
        }

        // Skip forward/backward 15 seconds
        function skipForward(audioId) {
            const audio = document.getElementById(audioId);
            if (audio) {
                audio.currentTime = Math.min(audio.currentTime + 15, audio.duration);
            }
        }

        function skipBackward(audioId) {
            const audio = document.getElementById(audioId);
            if (audio) {
                audio.currentTime = Math.max(audio.currentTime - 15, 0);
            }
        }

        // Overall Progress Tracking
        let segmentsWatched = {
            1: false,
            2: false,
            3: false
        };

        function updateOverallProgress(stage) {
            const steps = [
                document.getElementById('step1'),
                document.getElementById('step2'),
                document.getElementById('step3'),
                document.getElementById('step4')
            ];
            const progressFill = document.getElementById('progressFill');

            // Update step states
            steps.forEach((step, index) => {
                const dot = step.querySelector('.progress-dot');
                if (index < stage) {
                    // Completed stages
                    step.classList.add('complete');
                    step.classList.remove('active');
                    dot.classList.add('complete');
                    dot.classList.remove('active');
                    dot.textContent = '';
                } else if (index === stage - 1) {
                    // Current stage
                    step.classList.add('active');
                    step.classList.remove('complete');
                    dot.classList.add('active');
                    dot.classList.remove('complete');
                    dot.textContent = index + 1;
                } else {
                    // Future stages
                    step.classList.remove('active', 'complete');
                    dot.classList.remove('active', 'complete');
                    dot.textContent = index + 1;
                }
            });

            // Update progress fill (33% per stage, but stage 4 requires all segments)
            let fillPercentage = 0;
            if (stage === 1) fillPercentage = 0;
            else if (stage === 2) fillPercentage = 33;
            else if (stage === 3) fillPercentage = 66;
            else if (stage === 4) {
                // Check if all segments are watched
                const allSegmentsWatched = segmentsWatched[1] && segmentsWatched[2] && segmentsWatched[3];
                fillPercentage = allSegmentsWatched ? 100 : 75;
            }
            progressFill.style.width = fillPercentage + '%';
        }

        function markSegmentWatched(segmentNum) {
            segmentsWatched[segmentNum] = true;
            updateOverallProgress(4); // Recalculate stage 4 progress
        }

        // Video/Audio Player Functions
        let audio, progressBar, currentTimeDisplay, durationDisplay, waveBars;

        function initializePlayer() {
            audio = document.getElementById('videoAudio');
            progressBar = document.getElementById('progressBar');
            currentTimeDisplay = document.getElementById('currentTime');
            durationDisplay = document.getElementById('duration');
            waveBars = document.querySelectorAll('.wave-bar');

            console.log('Player initialized');
            console.log('Audio element:', audio);
            console.log('Audio source:', audio ? audio.querySelector('source').src : 'No audio element');

            if (audio) {
                audio.addEventListener('loadedmetadata', function() {
                    console.log('Audio metadata loaded, duration:', audio.duration);
                    durationDisplay.textContent = formatTime(audio.duration);
                });

                audio.addEventListener('loadstart', function() {
                    console.log('Audio loading started');
                });

                audio.addEventListener('canplay', function() {
                    console.log('Audio can play');
                });

                audio.addEventListener('timeupdate', function() {
                    const percentage = (audio.currentTime / audio.duration) * 100;
                    progressBar.style.width = percentage + '%';
                    currentTimeDisplay.textContent = formatTime(audio.currentTime);
                });

                audio.addEventListener('ended', function() {
                    console.log('Audio ended');
                    const mainPlayIcon = document.getElementById('mainPlayIcon');
                    if (mainPlayIcon) {
                        mainPlayIcon.textContent = '▶';
                    }
                    waveBars.forEach(bar => bar.classList.add('paused'));
                    progressBar.style.width = '0%';
                    videoWatched = true;
                });

                audio.addEventListener('error', function(e) {
                    console.error('Audio loading error:', e);
                    console.error('Error code:', audio.error ? audio.error.code : 'unknown');
                    console.error('Error message:', audio.error ? audio.error.message : 'unknown');
                    durationDisplay.textContent = 'Error';
                });

                // Try to load the audio
                audio.load();
            }
        }

        // Removed old togglePlayPause function - now using toggleVideo

        // New toggle function for bottom control button
        function toggleVideo() {
            if (!audio) initializePlayer();
            const mainPlayIcon = document.getElementById('mainPlayIcon');
            
            if (audio.paused) {
                const playPromise = audio.play();
                
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        mainPlayIcon.textContent = '⏸';
                        waveBars.forEach(bar => bar.classList.remove('paused'));
                    }).catch(error => {
                        console.error('Playback failed:', error);
                    });
                }
            } else {
                audio.pause();
                mainPlayIcon.textContent = '▶';
                waveBars.forEach(bar => bar.classList.add('paused'));
            }
        }

        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00';
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function seekVideo(event) {
            if (!audio) initializePlayer();
            const progressContainer = event.currentTarget;
            const clickX = event.offsetX;
            const width = progressContainer.offsetWidth;
            const percentage = clickX / width;
            audio.currentTime = percentage * audio.duration;
        }

        function moveToStage2() {
            document.getElementById('stage1').classList.add('hidden');
            document.getElementById('stage2').classList.remove('hidden');
            document.getElementById('stage2').classList.add('fade-in');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            updateOverallProgress(2);
        }

        function updateProgress() {
            let completed = 0;
            for (let i = 1; i <= totalItems; i++) {
                const checkbox = document.getElementById('check' + i);
                const item = checkbox.closest('.checklist-item');
                
                if (checkbox.checked) {
                    completed++;
                    item.classList.add('completed');
                } else {
                    item.classList.remove('completed');
                }
            }

            // Update progress bar
            const percentage = (completed / totalItems) * 100;
            document.getElementById('progressFill').style.width = percentage + '%';
            document.getElementById('progressText').textContent = completed + ' of ' + totalItems + ' completed';

            // Enable/disable final button
            const finalButton = document.getElementById('finalButton');

            if (completed === totalItems) {
                finalButton.disabled = false;
                finalButton.nextElementSibling.style.display = 'none';
            } else {
                finalButton.disabled = true;
                finalButton.nextElementSibling.style.display = 'block';
            }
        }

        function moveToFinal() {
            document.getElementById('stage2').classList.add('hidden');
            document.getElementById('stage3').classList.remove('hidden');
            document.getElementById('stage3').classList.add('fade-in');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            updateOverallProgress(3);
        }

        // Stage 4 Navigation Functions
        function moveToStage4() {
            document.getElementById('stage3').classList.add('hidden');
            document.getElementById('stage4').classList.remove('hidden');
            document.getElementById('stage4').classList.add('fade-in');
            // Hide all segment players
            document.getElementById('segment1Player').classList.add('hidden');
            document.getElementById('segment2Player').classList.add('hidden');
            document.getElementById('segment3Player').classList.add('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            updateOverallProgress(4);
        }

        function backToReady() {
            document.getElementById('stage4').classList.add('hidden');
            document.getElementById('stage3').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showSegment(segmentNum) {
            // Hide stage 4 selection screen
            document.getElementById('stage4').classList.add('hidden');
            
            // Hide all segment players first
            document.getElementById('segment1Player').classList.add('hidden');
            document.getElementById('segment2Player').classList.add('hidden');
            document.getElementById('segment3Player').classList.add('hidden');
            
            // Show the selected segment
            document.getElementById('segment' + segmentNum + 'Player').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            initializeSegmentPlayer(segmentNum);
        }

        function backToSegmentSelection() {
            // Pause all segments
            ['segment1Audio', 'segment2Audio', 'segment3Audio'].forEach(id => {
                const audio = document.getElementById(id);
                if (audio) {
                    audio.pause();
                    audio.currentTime = 0;
                }
            });
            
            document.getElementById('segment1Player').classList.add('hidden');
            document.getElementById('segment2Player').classList.add('hidden');
            document.getElementById('segment3Player').classList.add('hidden');
            document.getElementById('stage4').classList.remove('hidden');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Segment Audio Players
        const segmentPlayers = {
            1: { audio: null, playBtn: null, playIcon: null, progressBar: null, currentTime: null, duration: null, waveBars: null },
            2: { audio: null, playBtn: null, playIcon: null, progressBar: null, currentTime: null, duration: null, waveBars: null },
            3: { audio: null, playBtn: null, playIcon: null, progressBar: null, currentTime: null, duration: null, waveBars: null }
        };

        function initializeSegmentPlayer(segmentNum) {
            const player = segmentPlayers[segmentNum];
            player.audio = document.getElementById('segment' + segmentNum + 'Audio');
            player.playBtn = document.getElementById('segment' + segmentNum + 'PlayButton');
            player.playIcon = document.getElementById('segment' + segmentNum + 'PlayIcon');
            player.progressBar = document.getElementById('segment' + segmentNum + 'ProgressBar');
            player.currentTime = document.getElementById('segment' + segmentNum + 'CurrentTime');
            player.duration = document.getElementById('segment' + segmentNum + 'Duration');
            player.waveBars = document.querySelectorAll('#segment' + segmentNum + 'Player .wave-bar');

            if (player.audio) {
                player.audio.addEventListener('loadedmetadata', function() {
                    player.duration.textContent = formatTime(player.audio.duration);
                });

                player.audio.addEventListener('timeupdate', function() {
                    const percentage = (player.audio.currentTime / player.audio.duration) * 100;
                    player.progressBar.style.width = percentage + '%';
                    player.currentTime.textContent = formatTime(player.audio.currentTime);
                });

                player.audio.addEventListener('ended', function() {
                    player.playIcon.textContent = '▶';
                    player.playBtn.setAttribute('aria-label', 'Play audio');
                    player.waveBars.forEach(bar => bar.classList.add('paused'));
                    player.progressBar.style.width = '0%';
                    markSegmentWatched(segmentNum); // Mark as watched when completed
                });

                player.audio.load();
            }
        }

        // New toggle functions for bottom control buttons
        function toggleSegment1() {
            toggleSegmentPlayPause(1);
        }

        function toggleSegment2() {
            toggleSegmentPlayPause(2);
        }

        function toggleSegment3() {
            toggleSegmentPlayPause(3);
        }

        function toggleSegment1PlayPause() {
            toggleSegmentPlayPause(1);
        }

        function toggleSegment2PlayPause() {
            toggleSegmentPlayPause(2);
        }

        function toggleSegment3PlayPause() {
            toggleSegmentPlayPause(3);
        }

        function toggleSegmentPlayPause(segmentNum) {
            const player = segmentPlayers[segmentNum];
            if (!player.audio) return;

            if (player.audio.paused) {
                player.audio.play().then(() => {
                    player.playIcon.textContent = '⏸';
                    player.playBtn.setAttribute('aria-label', 'Pause audio');
                    player.waveBars.forEach(bar => bar.classList.remove('paused'));
                }).catch(error => {
                    console.error('Playback failed:', error);
                });
            } else {
                player.audio.pause();
                player.playIcon.textContent = '▶';
                player.playBtn.setAttribute('aria-label', 'Play audio');
                player.waveBars.forEach(bar => bar.classList.add('paused'));
            }
        }

        function seekSegment1(event) {
            seekSegment(1, event);
        }

        function seekSegment2(event) {
            seekSegment(2, event);
        }

        function seekSegment3(event) {
            seekSegment(3, event);
        }

        function seekSegment(segmentNum, event) {
            const player = segmentPlayers[segmentNum];
            if (!player.audio) return;

            const progressContainer = event.currentTarget;
            const clickX = event.offsetX;
            const width = progressContainer.offsetWidth;
            const percentage = clickX / width;
            player.audio.currentTime = percentage * player.audio.duration;
        }

        // Version Radio Button Functions
        function changeSegment1Version() {
            changeSegmentVersion(1);
        }

        function changeSegment2Version() {
            changeSegmentVersion(2);
        }

        function changeSegment3Version() {
            changeSegmentVersion(3);
        }

        function changeSegmentVersion(segmentNum) {
            const selectedVersion = document.querySelector('input[name="segment' + segmentNum + 'Version"]:checked').value;
            const source = document.getElementById('segment' + segmentNum + 'Source');
            const audio = document.getElementById('segment' + segmentNum + 'Audio');
            const wasPlaying = !audio.paused;
            const currentTime = audio.currentTime;

            if (selectedVersion === 'unclear') {
                // Switch to Michael's version
                const unclearFiles = {
                    1: 'ElevenLabs_Seg_1_Unclear.mp3',
                    2: 'ElevenLabs_Seg_2_Unclear.mp3',
                    3: 'ElevenLabs__Seg_3_Unclear.mp3'
                };
                source.src = unclearFiles[segmentNum];
            } else {
                // Switch to Rob's version
                const clearFiles = {
                    1: 'ElevenLabs_Seg_1_Clear.mp3',
                    2: 'ElevenLabs_Seg_2_Clear.mp3',
                    3: 'ElevenLabs_Seg_3_-_Clear.mp3'
                };
                source.src = clearFiles[segmentNum];
            }

            audio.load();
            audio.currentTime = currentTime;
            
            if (wasPlaying) {
                audio.play();
            }
        }

        // Initialize audio player when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            initializePlayer();
            updateOverallProgress(1); // Initialize to stage 1
        });
    </script>
</body>
</html>
